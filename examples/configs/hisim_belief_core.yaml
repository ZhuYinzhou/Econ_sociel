runner: "episode_runner"
mac: "basic_mac"
learner: "q_learner"

# Offline belief training (core users only) on a HuggingFace dataset saved via save_to_disk().
t_max: 50000  #test 2000
test_interval: 5000  #test 200
test_nepisode: 200 #32

# 这里的 n_agents 是“并行的执行器/信念网络副本数”，不是用户数
n_agents: 3
belief_dim: 128
batch_size_run: 1

# 关键：顶层 n_actions 统一为 5（与社交仿真一致），避免跨阶段 load_models 时 agent 输出层维度不一致。
# 注意：实际环境可用动作数量仍由 env_args.n_actions=3 控制（只做 stance_id 分类）。
n_actions: 5
env_action_source: "discrete_action_boxed"

# === Stage1/2: offline supervised classification for BeliefNetwork ===
# Train discrete stance-id head with cross-entropy on gt_action parsed from dataset answer (\\boxed{id})
train_belief_supervised: true
# Stage1/2: do NOT train BeliefEncoder (only train the agent's stance classifier / belief network)
freeze_belief_encoder_in_supervised: true
# Not needed in supervised mode; saves compute/memory
use_mixer: false

# ===== 必要默认超参（train.py 不会自动继承 src/config/config.yaml）=====
lr: 0.001
belief_net_lr: 0.001
encoder_lr: 0.001
mixer_lr: 0.001
weight_decay: 0.0
lambda_sd: 0.1
lambda_m: 0.1

# Network Architecture（BeliefNetwork 会读取 args.arch.*）
arch:
  entity_dim: 256
  attention_heads: 4
  transformer_blocks: 2
  key_dim: 64
  mlp_hidden_size: 256
  feedforward_size: 1024
  dropout_rate: 0.1
  layer_norm_epsilon: 0.00001

# Mixer / commitment features 维度（q_learner 会访问）
prompt_attention_heads: 2
commitment_embedding_dim: 1024

# 关键：离线训练不需要在线 LLM 调用
enable_llm_rollout: false
together_api_key: ""
coordinator_model: "gpt-4.1"
executor_model: "gpt-4.1"
llm_model_name: "gpt2"  # tokenizer only

env: "huggingface_dataset_env"
env_args:
  hf_dataset_path: "/home/zhuyinzhou/MAS/ECON/data/hisim_belief_dataset_metoo_e1"
  dataset_split: "train"
  question_field_name: "question"
  answer_field_name: "answer"
  max_question_length: 1024
  max_answer_length: 64
  dataset_streaming: false
  use_random_sampling: true
  use_dataset_episode: false
  # 只训练核心用户样本
  filter_is_core_user: "core"
  # 让 runner/buffer/action_selector 使用 n_actions=3 的形状
  n_actions: 3

# reward: 只用 TS（正确/错误），跳过 AL/CC 的额外开销
reward:
  al_weight: 0.0
  ts_weight: 1.0
  cc_weight: 0.0

train:
  buffer_size: 32
  batch_size: 16
  update_interval: 10
  optimizer: "adam"
  learning_rate: 0.001
  coordinator_learning_rate: 0.0005
  gamma: 0.99

system:
  use_cuda: true
  device_num: 0
  seed: 42
  debug: false

logging:
  use_tensorboard: true
  log_interval: 50
  save_model: true
  save_model_interval: 20000 #test 2000
  checkpoint_path: "./models"
  log_path: "./logs"
  experiment_name: "hisim-belief-core"


